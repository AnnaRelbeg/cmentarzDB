<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Profil osoby</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <style>
    body {
      background: url('assets/images/black_redflower.jpeg') no-repeat center center fixed;
      background-size: cover;
      background-attachment: scroll; /* prevents weird behaviour on mobile */
      font-family: 'Open Sans', sans-serif;
      color: #2f2f2f;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
  
    @media (max-width: 768px) {
      body {
        background-attachment: scroll;
        background-position: center top;
      }
    }
    
    /* ---------------------------------
       Slide Show 
    ---------------------------------*/
    /* Slideshow Styles */
    .slideshow-container {
      position: fixed; /* Set the slideshow container to a fixed position */
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1; /* Place it behind the content */
      overflow: hidden; /* Hide overflow */
  }

  .mySlides {
      max-width: 100%;
      position: absolute; /* Position slides absolutely within the container */
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
  }

  img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* Ensure images cover the entire container */
  }

  .slideshow-text {
      /* Your text styles for the slides */
      color: #fff;
      text-align: center;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%); /* Center text vertically and horizontally */
  }
  </style>
  

</head>
<body>
  <!-- Move the slideshow-container outside of the main section -->
  <div class="slideshow-container">
    <!-- Slides for the image slideshow -->
    <div class="mySlides fade">
        <img src="assets/images/black_flower.jpeg" alt="Slideshow Image 1">
    </div>
    <div class="mySlides fade">
        <img src="assets/images/black_flower.jpeg" alt="Slideshow Image 2">
    </div>
    <!-- Add more slides as needed -->
</div>



  <div id="profile-container">
    <h1 id="profile-name">Ładowanie...</h1>
    <div class="swiper profileSwiper">
        <div class="swiper-wrapper" id="profile-gallery">
          <!-- Slides will be inserted here -->
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-pagination"></div>
      </div>      
    <p><strong>ID grobu:</strong> <span id="profile-id"></span></p>
    <p><strong>Data urodzenia:</strong> <span id="profile-birth"></span></p>
    <p><strong>Data śmierci:</strong> <span id="profile-death"></span></p>
    <p><strong>Wiek:</strong> <span id="profile-age"></span> lat</p>
    <p id="profile-description"></p>
    <div id="profile-memory">
        <h2>Wspomnienie</h2>
        <p id="profile-memory-text">Brak wspomnienia.</p>
      </div>      
    <a class="back-button" href="index.html">← Powrót</a>
  </div>
  <script>// Slideshow
    let slideIndex = 0;
    function showSlides() {
        const slides = document.getElementsByClassName("mySlides");
        for (let i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        slideIndex = (slideIndex + 1) % slides.length;
        slides[slideIndex].style.display = "block";
        setTimeout(showSlides, 2000000);
    }
    showSlides();
    </script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
  
    const firebaseConfig = {
      apiKey: "AIzaSyChVtFHlA4mDuwx-xi7jLGMWvNYcNrrANM",
      authDomain: "cmentarz-dabrowki.firebaseapp.com",
      projectId: "cmentarz-dabrowki",
      storageBucket: "cmentarz-dabrowki.appspot.com",
      messagingSenderId: "502809191219",
      appId: "1:502809191219:web:9526a28823974e90c91446",
      measurementId: "G-GEDTJPLZ87"
    };
  
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
  
    const params = new URLSearchParams(window.location.search);
    const personId = params.get("id");
  
    const galleryContainer = document.getElementById("profile-gallery");
  
    if (personId) {
      const docRef = doc(db, "zmarli", personId);
      getDoc(docRef).then(docSnap => {
        if (docSnap.exists()) {
          const data = docSnap.data();
  
          document.getElementById("profile-name").textContent = data.fullName;
          document.getElementById("profile-id").textContent = data.id;
          document.getElementById("profile-birth").textContent = data.birthDate;
          document.getElementById("profile-death").textContent = data.deathDate;
          document.getElementById("profile-age").textContent = data.age;
          document.getElementById("profile-description").textContent = data.description;
          document.getElementById("profile-memory-text").textContent = data.memoryText || "Brak wspomnienia.";

          if (data.photoGallery?.length) {
            data.photoGallery.forEach((url) => {
              const slide = document.createElement("div");
              slide.classList.add("swiper-slide");
              slide.innerHTML = `<img src="${url}" alt="${data.fullName}" />`;
              galleryContainer.appendChild(slide);
            });
  
            new Swiper(".profileSwiper", {
              loop: true,
              effect: "fade",
              speed: 1000,
              autoplay: {
                delay: 5000,
                disableOnInteraction: false
            },
              pagination: { el: ".swiper-pagination", clickable: true },
              navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
              },
            });
          }
        } else {
          document.getElementById("profile-name").textContent = "Nie znaleziono profilu.";
        }
      });
    } else {
      document.getElementById("profile-name").textContent = "Brak ID profilu w adresie URL.";
    }
  </script>
</body>
</html>
